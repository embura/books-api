// Generated by CoffeeScript 1.11.1
(function() {
  var extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  describe('td.object', function() {
    describe('making a test double object based on a Prototypal thing', function() {
      Given(function() {
        var Thing;
        return this.someType = Thing = (function() {
          function Thing() {}

          Thing.prototype.foo = function() {};

          Thing.prototype.bar = function() {};

          Thing.prototype.notAFunc = 11;

          return Thing;

        })();
      });
      Given(function() {
        return this.testDouble = td.object(this.someType);
      });
      When(function() {
        return td.when(this.testDouble.bar()).thenReturn('yay');
      });
      Then(function() {
        return this.testDouble.bar() === 'yay';
      });
      And(function() {
        return this.testDouble.toString() === '[test double object for "Thing"]';
      });
      And(function() {
        return this.testDouble.foo.toString() === '[test double for "Thing#foo"]';
      });
      return And(function() {
        return this.testDouble.notAFunc === 11;
      });
    });
    describe('making a test double based on a plain object funcbag', function() {
      Given(function() {
        return this.funcBag = {
          lol: function() {},
          kek: function() {},
          now: function() {},
          otherThing: 8
        };
      });
      Given(function() {
        return this.testDouble = td.object(this.funcBag);
      });
      When(function() {
        return td.when(this.testDouble.kek()).thenReturn('nay!');
      });
      Then(function() {
        return this.testDouble.kek() === 'nay!';
      });
      And(function() {
        return this.testDouble.toString() === '[test double object]';
      });
      And(function() {
        return this.testDouble.now.toString() === '[test double for ".now"]';
      });
      return And(function() {
        return this.testDouble.otherThing === 8;
      });
    });
    describe('making a test double based on an array of strings', function() {
      Given(function() {
        return this.testDouble = td.object(['biz', 'bam', 'boo']);
      });
      When(function() {
        return td.when(this.testDouble.biz()).thenReturn('zing!');
      });
      Then(function() {
        return this.testDouble.biz() === 'zing!';
      });
      And(function() {
        return this.testDouble.toString() === '[test double object]';
      });
      return And(function() {
        return this.testDouble.bam.toString() === '[test double for ".bam"]';
      });
    });
    describe('making a test double on a subtype', function() {
      Given(function() {
        var SuperType;
        return this.someSuperType = SuperType = (function() {
          function SuperType() {}

          SuperType.prototype.foo = function() {};

          return SuperType;

        })();
      });
      Given(function() {
        var SubType;
        return this.someSubType = SubType = (function(superClass) {
          extend(SubType, superClass);

          function SubType() {
            return SubType.__super__.constructor.apply(this, arguments);
          }

          SubType.prototype.bar = function() {};

          return SubType;

        })(this.someSuperType);
      });
      Given(function() {
        return this.testDouble = td.object(this.someSubType);
      });
      When(function() {
        return td.when(this.testDouble.foo()).thenReturn('yay');
      });
      When(function() {
        return td.when(this.testDouble.bar()).thenReturn('yay');
      });
      Then(function() {
        return this.testDouble.foo() === 'yay';
      });
      return Then(function() {
        return this.testDouble.bar() === 'yay';
      });
    });
    if (global.Proxy != null) {
      return describe('creating a proxy object (ES2015; only supported in FF + Edge atm)', function() {
        Given(function() {
          return this.testDouble = td.object('Thing');
        });
        Given(function() {
          return this.testDouble.magic('sauce');
        });
        When(function() {
          return td.when(this.testDouble.whateverYouWant()).thenReturn('YESS');
        });
        Then(function() {
          return td.verify(this.testDouble.magic('sauce'));
        });
        And(function() {
          return this.testDouble.whateverYouWant() === 'YESS';
        });
        And(function() {
          return this.testDouble.toString() === '[test double object for "Thing"]';
        });
        And(function() {
          return this.testDouble.foo.toString() === '[test double for "Thing#foo"]';
        });
        context('with custom excludeMethods definitions', function() {
          Given(function() {
            return this.testDouble = td.object('Stuff', {
              excludeMethods: ['then', 'fun']
            });
          });
          return Then(function() {
            return this.testDouble.fun === void 0;
          });
        });
        return context('unnamed double', function() {
          Given(function() {
            return this.testDouble = td.object();
          });
          Then(function() {
            return this.testDouble.toString() === '[test double object]';
          });
          return Then(function() {
            return this.testDouble.lol.toString() === '[test double for "#lol"]';
          });
        });
      });
    } else {
      return describe('getting an error message', function() {
        When(function() {
          var error;
          try {
            return td.object('Woah');
          } catch (error1) {
            error = error1;
            return this.error = error;
          }
        });
        return Then(function() {
          return this.error.message === "The current runtime does not have Proxy support, which is what\ntestdouble.js depends on when a string name is passed to `td.object()`.\n\nMore details here:\n  https://github.com/testdouble/testdouble.js/blob/master/docs/4-creating-test-doubles.md#objectobjectname\n\nDid you mean `td.object(['Woah'])`?";
        });
      });
    }
  });

}).call(this);
